<?xml version="1.0" ?>
<tool id="qiime_cutadapt_demux-single" name="qiime cutadapt demux-single" version="2019.4">
	<description> - Demultiplex single-end sequence data with barcodes in- sequence.</description>
	<requirements>
		<requirement type="package" version="2019.4">qiime2</requirement>
	</requirements>
	<command><![CDATA[
qiime cutadapt demux-single

--i-seqs=$iseqs
--m-barcodes-column="$mbarcodescolumn"
--o-per-sample-sequences=opersamplesequences
--o-untrimmed-sequences=ountrimmedsequences


#if $input_files_mbarcodesfile:
#def list_dict_to_string(list_dict):
  #set $file_list = list_dict[0]['additional_input'].__getattr__('file_name')
  #for d in list_dict[1:]:
	  #set $file_list = $file_list + ',' + d['additional_input'].__getattr__('file_name')
  #end for
  #return $file_list
#end def
--m-barcodes-file=$list_dict_to_string("$input_files_mbarcodesfile")
#end if

#if $perrorrate:
 --p-error-rate=$perrorrate
#end if

;

cp opersamplesequences.qza $opersamplesequences;
cp ountrimmedsequences.qza $ountrimmedsequences
	]]></command>
	<inputs>
		<param format="qza,no_unzip.zip" label="--i-seqs: ARTIFACT MultiplexedSingleEndBarcodeInSequence The single-end sequences to be demultiplexed. [required]" name="iseqs" optional="False" type="data"/>
		<repeat name="$input_files_mbarcodesfile" optional="False" title="--m-barcodes-file">
			<param label="--m-barcodes-file: Metadata file or artifact viewable as metadata. This option may be supplied multiple times to merge metadata. [required]" name="additional_input" type="data" format="tabular,qza,no_unzip.zip" />
		</repeat>
		<param label="--m-barcodes-column: COLUMN  MetadataColumn[Categorical] The sample metadata column listing the per-sample barcodes.                                 [required]" name="mbarcodescolumn" optional="False" type="text"/>
		<param label="--p-error-rate: PROPORTION Range(0, 1, inclusive_end=True) The level of error tolerance, specified as the maximum allowable error rate. The default value specified by cutadapt is 0.1 (=10%), which is greater than `demux emp-*`, which is 0.0 (=0%). [default: 0.1]" name="perrorrate" optional="True" type="float" min="0" max="1" exclude_max="False" value="0.1"/>
	</inputs>
	<outputs>
		<data format="qza" label="${tool.name} on ${on_string}: persamplesequences.qza" name="opersamplesequences"/>
		<data format="qza" label="${tool.name} on ${on_string}: untrimmedsequences.qza" name="ountrimmedsequences"/>
	</outputs>
	<help><![CDATA[
Demultiplex single-end sequence data with barcodes in-sequence.
###############################################################

Demultiplex sequence data (i.e., map barcode reads to sample ids). Barcodes
are expected to be located within the sequence data (versus the header, or
a separate barcode file).

Parameters
----------
seqs : MultiplexedSingleEndBarcodeInSequence
    The single-end sequences to be demultiplexed.
barcodes : MetadataColumn[Categorical]
    The sample metadata column listing the per-sample barcodes.
error_rate : Float % Range(0, 1, inclusive_end=True), optional
    The level of error tolerance, specified as the maximum allowable error
    rate. The default value specified by cutadapt is 0.1 (=10%), which is
    greater than `demux emp-*`, which is 0.0 (=0%).

Returns
-------
per_sample_sequences : SampleData[SequencesWithQuality]
    The resulting demultiplexed sequences.
untrimmed_sequences : MultiplexedSingleEndBarcodeInSequence
    The sequences that were unmatched to barcodes.
	]]></help>
<macros>
    <import>qiime_citation.xml</import>
</macros>
<expand macro="qiime_citation"/>
</tool>
